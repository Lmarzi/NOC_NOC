function [X C I out] = hev(inp,par)

%The function HEV computes the resulting state-of-charge based on current state-
%   of-charge, inputs and drive cycle demand.
%   
%   [X C I out] = HEV(INP,PAR)
%
%   INP   = input structure
%   PAR   = user defined parameters
%
%   X     = resulting state-of-charge
%   C     = cost matrix
%   I     = infeasible matrix
%   out   = user defined output signals


% VEHICLE PARAMETERS
wheel_radius = 0.281154; %m
vehicle_mass = 1200; %kg

% Coasting down test parameters
a_cd = 93.086154;  %N
b_cd = 2.5373490;  %N/(m/s))
c_cd = 0.38382359; %N/(m/s)^2)
g=9.81;


% Wheel speed (rad/s)
wv  = inp.W{1} ./ wheel_radius;
% Wheel acceleration (rad/s^2)
dwv = inp.W{2} ./ wheel_radius;
% Vehicle torque request (Nm)
Tv = (vehicle_mass*g*sin(inp.W{4})+a_cd*cos(inp.W{4})+b_cd.*inp.W{1}*cos(inp.W{4}) + c_cd.*inp.W{1}.^2 + vehicle_mass.*inp.W{2}) .* wheel_radius;

% TRANSMISSION
gearbox_efficiency = 0.96;
% final drive ratio (from main axle to wheel)
t0 = 3.1725494;
% gear box (from motor to main axle) 1st to 5th gear
tprime = [3.417 1.958 1.276 0.943 0.757];
% gear ratios
r_gear = t0.*tprime;
% Crankshaft speed (rad/s)
wg  = (inp.W{3}>0) .* r_gear(inp.W{3} + (inp.W{3}==0)) .* wv; 

% Crankshaft acceleration (rad/s^2)
dwg = (inp.W{3}>0) .* r_gear(inp.W{3} + (inp.W{3}==0)) .* dwv;
% Crankshaft torque (Nm)
Tg  = (inp.W{3}>0) .* (Tv>0)  .* Tv ./ r_gear(inp.W{3} + (inp.W{3}==0)) ./ gearbox_efficiency...
    + (inp.W{3}>0) .* (Tv<=0) .* Tv ./ r_gear(inp.W{3} + (inp.W{3}==0)) .* gearbox_efficiency;

% TORQUE SPLIT 
% ICE DATA

idle_speed     = 100; %rad/s
%
Te0_list = [0	6.58713240000000	13.2427990000000	19.8984650000000	26.5541310000000	33.2097970000000	39.8654630000000	46.5211290000000	53.1767950000000	59.8324610000000	66.4881280000000	73.1437940000000	79.7994600000000	86.4551260000000	93.1107920000000	99.7664580000000	106.422120000000	113.077790000000	119.733460000000	126.389120000000	133.044790000000	139.700450000000	146.356120000000	153.011790000000];
we_list  = [0	52.3598780000000	78.5398160000000	104.719760000000	130.899690000000	157.079630000000	183.259570000000	209.439510000000	235.619450000000	261.799390000000	287.979330000000	314.159270000000	340.339200000000	366.519140000000	418.879020000000	471.238900000000	523.598780000000	575.958650000000	628.318530000000	680.678410000000	733.038290000000];

% Total required torque (Nm)
Ttot = Tg;
Ttot2 = Tg;
% Torque provided by engine
Te  = (wg>0) .* (Ttot>0)  .* (1-inp.U{1}).*Ttot;
Tb  = (wg>0) .* (Ttot<=0) .* (1-inp.U{1}).*Ttot;
%Case without EM
Te2  = (wg>0) .* (Ttot2>0)  .* (1).*Ttot2;
Tb2  = (wg>0) .* (Ttot2<=0) .* (1).*Ttot2;
% Torque provided by electric motor
Tm  = (wg>0) .*    inp.U{1} .*       Ttot;
inps = (Te>0).*(wg<idle_speed) + (Ttot<0).*(Tm>0);

% ENGINE
gasoline_lower_heating_value = 43.308*10^6; %J/kg
%   
% engine internal efficiency
eta  = [
NaN	0.000985176867508542	0.00104826367417989	0.00112214975098353	0.00119869301792298	0.00126793487682310	0.00132576481847820	0.00136940657571882	0.00139910891439717	0.00141885989895168	0.00143349974309684	0.00144658991461476	0.00145974553702510	0.00147386524492068	0.00150719382291554	0.00154434163928790	0.00156795359216020	0.00155217380450740	0.00150864717135866	0.00145327616139276	0.00139714442339915
NaN	0.0819399790831982	0.0872833659579903	0.0934870250618059	0.0996083482572143	0.104662319099298	0.108294376957084	0.110435790791019	0.111395756098731	0.111706254626048	0.111783116678594	0.111835411813953	0.111893055301263	0.111961343195404	0.111980233096452	0.111570784583218	0.108792601925399	0.103472285985269	0.0972247971502893	0.0910256470792751	0.0853701011082966
NaN	0.145393763493630	0.155155156586610	0.165810810549683	0.176322601988724	0.184421168271825	0.188902556189124	0.190408719740783	0.190374008606551	0.189664720300343	0.188839570415178	0.188008263687098	0.187297096420401	0.186528489234596	0.184135528114002	0.180616006241626	0.171107624687906	0.159004232768166	0.146826088726952	0.135612075882292	0.125776505240612
NaN	0.194060846422817	0.207410406583586	0.221602632214219	0.235474705100449	0.246153736589742	0.249501409988707	0.248862102656193	0.247875702156245	0.246374158192340	0.244817907025220	0.242850181376088	0.241545846698982	0.239942090351005	0.235109126732724	0.228326020975746	0.210865152962617	0.193071911864631	0.176452812336487	0.161756163195793	0.149140880964793
NaN	0.230252492051949	0.246311287174143	0.263444350345495	0.279541968254500	0.291838378595322	0.294517990014221	0.292417561522457	0.291206955712915	0.290297718737046	0.287819359858557	0.284980089635858	0.282997082429670	0.280664789343696	0.274496803145001	0.263930288570315	0.237994206246046	0.215872751858812	0.195987365827721	0.178883981208320	0.164391711164306
NaN	0.255932575440223	0.273449716694754	0.292758344905371	0.311049973426464	0.325394755416787	0.328940938888619	0.329296031610544	0.324998867015812	0.324528383379910	0.321453089844651	0.319727706055674	0.315578317493862	0.312470824825423	0.308282614984553	0.290811526993758	0.257447759890738	0.232007815063297	0.209712104828654	0.190955494695103	0.175175061390573
NaN	0.273253098035737	0.290921555000731	0.310365235881954	0.331159613907399	0.346354062457175	0.351588462461568	0.350944893505163	0.349129698807621	0.347330343436863	0.347297031750723	0.344713662442429	0.341844098346117	0.338390785312181	0.332392672787757	0.310074537117811	0.272835318773564	0.243755978894436	0.219796993592265	0.199933486518238	0.183262363232734
NaN	0.284218807698343	0.301496293389782	0.320377204543394	0.341178296096669	0.358710395061706	0.365290496073630	0.364540946791045	0.363489526705305	0.363005664894466	0.361940638033927	0.360450691051873	0.358758517436533	0.355471132895703	0.349651809429890	0.323846585380624	0.284171778852602	0.252446566020096	0.227483460389308	0.206903873308860	0.189621067394878
NaN	0.290513170552274	0.307247051494476	0.325634804241976	0.345539001801729	0.363383757388939	0.367819641622270	0.366118269779877	0.366006573594413	0.367607258442702	0.368371076833506	0.366977276806769	0.365557899387330	0.364442774151856	0.358737753406550	0.331275695308851	0.291504219850217	0.258927639037612	0.233528841672631	0.212512414617259	0.194827378307549
NaN	0.293531515404167	0.309418071909336	0.327155764458296	0.347576883173789	0.363129759798378	0.366515431050214	0.365846159365528	0.367584152336040	0.369848288250413	0.373455522925835	0.372693634321097	0.370715907478497	0.367690158904035	0.364699236600993	0.338367710967052	0.295268096825972	0.263821169631539	0.238397586102472	0.217160771607492	0.199249593643664
NaN	0.294438696907274	0.309238908625886	0.325935560404433	0.345096629523407	0.359918952610953	0.365100691226632	0.366231770969379	0.369031625981964	0.373673308961779	0.378109172467402	0.376496575157275	0.375247755967512	0.372191113962967	0.366434911911928	0.343764152366285	0.297359271018360	0.267621021842452	0.242365103417554	0.221107800946780	0.203138366493011
NaN	0.294095262550264	0.307627307403779	0.322551659859426	0.340158093130054	0.356459060605006	0.364280394746709	0.366277885937570	0.368479375970230	0.372946751246583	0.378140580828800	0.379244258334169	0.378720785957259	0.376786500203286	0.370336021528762	0.346040461647427	0.300314890014004	0.270570417280455	0.245601843674237	0.224528511356726	0.206674263738656
NaN	0.292996909687947	0.305515981297019	0.318988140954746	0.335706634212170	0.353233847636460	0.361789072092477	0.364512854309209	0.366011264866315	0.369315717384603	0.374518109529886	0.378149700377597	0.379887353694840	0.378636581484407	0.370196890644049	0.344853182809236	0.303234459145337	0.272850408429440	0.248239687266387	0.227548267928509	0.209994113921078
NaN	0.291410931599040	0.303444273853021	0.316603018932733	0.332169346109193	0.348433087063093	0.357014008451797	0.361328262096543	0.363959145020265	0.366714680487971	0.370206178998311	0.374321198678922	0.378209991504939	0.378984377808289	0.367162723709306	0.342886697441954	0.304840574836443	0.274466733652988	0.250373713733890	0.230261287210328	0.213205763703739
NaN	0.289531788756749	0.301184253113838	0.314293640178033	0.329059860440956	0.342388759204950	0.351126702935769	0.357019731466408	0.361595407491206	0.364770570399056	0.366666739852504	0.369591327641382	0.373107561435548	0.374560427409671	0.366087559383082	0.342878541265046	0.304302564787538	0.275393858082509	0.252051635140373	0.232740127191565	0.216395603999408
NaN	0.287503603647644	0.298355919096279	0.310612459830304	0.324573607626048	0.336926058862486	0.345224908577537	0.351145498191158	0.357123316597945	0.362311706504057	0.365153987685535	0.366604149447198	0.367470017721991	0.368315402500052	0.367231545101178	0.344506122649518	0.302379415918432	0.275642950470769	0.253281337785101	0.235043160459201	0.219630679830762
NaN	0.285424995892342	0.295026586899683	0.305739701936203	0.317732239881934	0.330310071897941	0.338594966944528	0.343967733936653	0.350580379944456	0.357113954233405	0.361130619549887	0.363219246647612	0.364522146228517	0.364918803269965	0.365065195217870	0.343555798408358	0.301627174640378	0.275107858944411	0.254071990082472	0.237221664679586	0.222957455132527
NaN	0.283415356619179	0.291506125451005	0.300621170722794	0.311760295439493	0.323818589410097	0.331645384569932	0.337425661485504	0.343740049070026	0.349607498883208	0.353802739431731	0.355739043407135	0.357037872267909	0.357068112991351	0.355885322561926	0.335174538499164	0.300010953212124	0.273755800100736	0.254488291848879	0.239320884939281	0.226399203927180
NaN	0.281646652002592	0.288257504419658	0.295559214529940	0.304431644360439	0.315756619323695	0.324762510633402	0.329570811397338	0.336193720795518	0.341490944790012	0.344141494334425	0.344828128631793	0.344756462112198	0.343513789175603	0.339708180826660	0.320887502133089	0.296439806038114	0.271370815942287	0.254624179460841	0.241373706200061	0.229954286019380
NaN	0.280167924787019	0.285478763962490	0.291172052790207	0.297736094884384	0.305794172648336	0.314737871981583	0.320659242552989	0.325783350239498	0.329073141508356	0.331003537199181	0.331759962341477	0.328406699884215	0.325946934063137	0.318577235244835	0.297189378401947	0.286368168119735	0.268384140546607	0.254559780982915	0.243390571820681	0.233596451440744
NaN	0.278946456417368	0.283155778919852	0.287657427358849	0.293015180770520	0.298566351477990	0.303811449673223	0.309965824431662	0.313341435581740	0.314294669700013	0.314195689691944	0.313214969722858	0.310048883041244	0.304285487707142	0.291568342883522	0.279054411121099	0.275344977098892	0.264595661260598	0.254286262451595	0.245361125263463	0.237277479778908
NaN	0.277948739635364	0.281243182870711	0.284765805081032	0.288935546854832	0.292885177682744	0.296771194287260	0.300634149863317	0.302335627047591	0.302200257791813	0.300712097886913	0.298068403735308	0.293941444092869	0.287948307619518	0.274451417865708	0.266477685063631	0.265160548420959	0.260295626817544	0.253810506243978	0.247259431847733	0.240931695663236
NaN	0.277121273619044	0.279621056253695	0.282277715491064	0.285427344370314	0.288190197117811	0.290587890568884	0.292279547686600	0.292662479187770	0.291529054303976	0.288972022711830	0.285152660126566	0.280211520849682	0.274411672477625	0.261979215820368	0.256440264122668	0.256438576291388	0.255951452173623	0.253202601107717	0.249057560204997	0.244485982859754
NaN	0.276401450439115	0.278190474068907	0.280079192609239	0.282349624994804	0.284052823455048	0.285061161421990	0.285173763251004	0.284307404813413	0.282231899760105	0.278810499467822	0.274181760402151	0.268756398542043	0.263048156227254	0.251973060880951	0.247996458759204	0.249010092949877	0.251912625072848	0.252569448248786	0.250737953735784	0.247875970353921];


%Max eng torque
Tmax = [0 50 80 153.012 153.012 153.012 153.012 153.012 153.012 153.012 153.012 153.012 153.012 153.012 153.012 153.012 153.012 153.012 153.012 150.15 128.6901];
% Engine efficiency (function of speed)
e_th = interp2(we_list,Te0_list,eta,wg.*ones(size(Te)),Te);
e_th2 = interp2(we_list,Te0_list,eta,wg.*ones(size(Te2)),Te2);
e_th(isnan(e_th)) = 0.28;
e_th2(isnan(e_th2)) = 0.28;

% Fuel mass flow (function of power and efficiency)
m_dot_fuel = Te.*wg./e_th./gasoline_lower_heating_value;
%CASE 2_ONLY ICE
m_dot_fuel2 = Te2.*wg./e_th2./gasoline_lower_heating_value;
% Maximum engine torque
Te_max = interp1(we_list,Tmax,wg,'linear','extrap');
% Fuel power consumption
Pe = m_dot_fuel .* gasoline_lower_heating_value;
%CASE 2_ONLY ICE
Pe2 = m_dot_fuel2 .* gasoline_lower_heating_value;
% Calculate infeasible
ine = (Te > Te_max);


% Electric Motor
% motor speed list
wm_list = [62.8318530717959	68.0678408277789	73.3038285837618	78.5398163397448	83.7758040957278	89.0117918517108	94.2477796076938	99.4837673636768	104.719755119660	109.955742875643	115.191730631626	120.427718387609	125.663706143592	130.899693899575	136.135681655558	141.371669411541	146.607657167524	151.843644923507	157.079632679490	162.315620435473	167.551608191456	172.787595947439	178.023583703422	183.259571459405	188.495559215388	193.731546971371	198.967534727354	204.203522483337	209.439510239320	214.675497995303	219.911485751286	225.147473507269	230.383461263252	235.619449019235	240.855436775217	246.091424531200	251.327412287183	256.563400043166	261.799387799149	267.035375555132	272.271363311115	277.507351067098	282.743338823081	287.979326579064	293.215314335047	298.451302091030	303.687289847013	308.923277602996	314.159265358979	319.395253114962	324.631240870945	329.867228626928	335.103216382911	340.339204138894	345.575191894877	350.811179650860	356.047167406843	361.283155162826	366.519142918809	371.755130674792	376.991118430775	382.227106186758	387.463093942741	392.699081698724	397.935069454707	403.171057210690	408.407044966673	413.643032722656	418.879020478639	424.115008234622	429.350995990605	434.586983746588];
% motor torque list
Tm_list = [ 10	20	30	40	50	60	70	80	90	100	110	120	130	140	150	160	170	180	190	200	210	220	230	240	250];
% motor maximum torque (indexed by speed list)
Tmmax   = [	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	100	98.7858267466937	97.1114907001395	95.4929658551372	93.9275073984956	92.4125476017457	90.9456817667973	89.5246554891911	88.1473530970497	86.8117871410338	85.5160888254960	84.2584992839446	83.0373616131628	81.8511135901176	80.6982810043413	79.5774715459477	78.4873691960032	77.4267290717329	76.3943726841098	75.3891835698452	74.4101032637433	73.4561275808748	72.5263031811169	71.6197243913529	70.7355302630646	69.8729018452223	69.0310596543161	68.2092613250980];
% motor minimum torque (indexed by speed list)
Tmmin   = [	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-50	-49.3929133733468	-48.5557453500698	-47.7464829275686	-46.9637536992478	-46.2062738008728	-45.4728408833987	-44.7623277445956	-44.0736765485249	-43.4058935705169	-42.7580444127480	-42.1292496419723	-41.5186808065814	-40.9255567950588	-40.3491405021707	-39.7887357729738	-39.2436845980016	-38.7133645358664	-38.1971863420549	-37.6945917849226	-37.2050516318716	-36.7280637904374	-36.2631515905584	-35.8098621956765	-35.3677651315323	-34.9364509226112	-34.5155298271580	-34.1046306625490];
% motor efficiency map (indexed by speed list and torque list)
etam =[0.902752861568703	0.917988106894149	0.919184056082856	0.916420181237379	0.911722954460600	0.905776681188789	0.898882190667757	0.891196508571890	0.882812747877166	0.873792065210356	0.864178186462303	0.854004669594557	0.843298815381411	0.832083902119633	0.820380526454314	0.808207441395011	0.795582098561495	0.782521009680914	0.769039993927956	0.755154351062963	0.740878985102016	0.726228494258811	0.711217237423439	0.695859384021469	0.680168951906854
	0.902144562195189	0.919086512230633	0.921180848650277	0.919113281665970	0.915030775453713	0.909657169850201	0.903309697738036	0.896153114392040	0.888284407261355	0.879766679882279	0.870644553656834	0.860951868742050	0.850715830682649	0.839959379915446	0.828702613471980	0.816963673542666	0.804759322430066	0.792105325851070	0.779016715196282	0.765507971111595	0.751593154627881	0.737286002528042	0.722599997835701	0.707548422681715	0.692144398482731
	0.901429644774190	0.920015461574574	0.922943530044231	0.921507161431206	0.917974185309830	0.913108184308817	0.907242956215271	0.900551129500698	0.893133701829668	0.885055855463285	0.876363236988033	0.867090097180204	0.857263674009815	0.846906697214278	0.836038891042605	0.824677913470528	0.812839963927939	0.800540188450510	0.787792956888696	0.774612056954044	0.761010832823692	0.747002285943643	0.732599149535537	0.717813944476722	0.702659021769117
	0.900620575093458	0.920799529259532	0.924508906255074	0.923650888957982	0.920614508310764	0.916203269933361	0.910767672210696	0.904488335814559	0.897470380210906	0.889781174262771	0.881467495595235	0.872564110277906	0.863098392653944	0.853092965242367	0.842567282679430	0.831538621681990	0.820022721612031	0.808034211519691	0.795586902330582	0.782693991376929	0.769368208491227	0.755621922256184	0.741467218537283	0.726915959382201	0.711979827784373
	0.899726950494060	0.921457539762860	0.925905144600084	0.925582003329413	0.922998652431517	0.918998678079892	0.913949394931704	0.908039515825492	0.901378375013740	0.894035617455904	0.886059239406151	0.877484608707232	0.868339321871793	0.858645979557415	0.848423851851632	0.837689919075076	0.826459545242327	0.814746927035815	0.802565400998495	0.789927658568714	0.776845899676544	0.763331944450213	0.749397315781717	0.735053301251041	0.720311000188559
	0.898756296661131	0.922004164887984	0.927154173354875	0.927329716881777	0.925163113869950	0.921538169984208	0.916839115821802	0.911262841329653	0.904922973943421	0.897891509843136	0.890217737251212	0.881937698081452	0.873079282673135	0.863665141067622	0.853714429774337	0.843243903499495	0.832268621558807	0.820802418819292	0.808858227922614	0.796448304841421	0.783584389991016	0.770277825401480	0.756539641323156	0.742380621180762	0.727811350938513
	0.897714612796484	0.922451016573329	0.928273323606467	0.928917106453677	0.927136716988140	0.923856303635601	0.919477099551108	0.914204244663201	0.908155726355304	0.901405955738281	0.894005575047058	0.885991361338927	0.877391559254175	0.868228928307875	0.858522571264952	0.848289076874609	0.837543259286711	0.826298650996052	0.814567840119999	0.802362706492851	0.789694590304666	0.776574414747680	0.763012776668003	0.749020014554399	0.734606260209755
	0.896606753239438	0.922807411858571	0.929276478550429	0.930362647260468	0.928942532271321	0.925980734588484	0.921895565709698	0.916900478567299	0.911117877842328	0.904624644090181	0.897472826524994	0.889699989411832	0.881334783200948	0.872400128033074	0.862915123842594	0.852896244172027	0.842358108640224	0.831313997921164	0.819776206097867	0.807756287310135	0.795265231931508	0.782313594697960	0.768911589411718	0.755069159969124	0.740796034341816
	0.895436700053132	0.923080919289103	0.930174894417424	0.931681308518832	0.930599246298562	0.927933859399265	0.924120604302854	0.919381301805965	0.913842823511776	0.907584566426741	0.900660032322729	0.893107617418111	0.884956422206019	0.876229571356224	0.866946205656253	0.857122726974591	0.846773603825106	0.835911908409995	0.824549684070228	0.812698202500852	0.800368147476213	0.787569748468293	0.774312879408099	0.760607132756693	0.746461875799190
	0.894207761269107	0.923277756301095	0.930977797510679	0.932885350264662	0.932122158085079	0.929734010853170	0.926173568838518	0.921671068706338	0.916357892186568	0.910315993541507	0.903600366596561	0.896250278255615	0.888295317317004	0.879758850939776	0.870660098523461	0.861015427882916	0.850839193949699	0.840144297906324	0.828942569751790	0.817245036097470	0.805062111449870	0.792403737325378	0.779279485074198	0.765698632998309	0.751670224961109
	0.892922717415915	0.923403082940893	0.931692825494564	0.933984912305409	0.933523915509158	0.931396341392754	0.928072106000625	0.923789904036259	0.918685665162724	0.912843936522879	0.906321238430377	0.899157742215172	0.891383558294164	0.883022329354442	0.874093386263213	0.864613095511522	0.854595731089587	0.844054055737034	0.832999718640420	0.821443533821498	0.809395678985983	0.796865840140829	0.783863318485271	0.770397110579092	0.756475969270518
	0.891583931415577	0.923461222154565	0.932326358361017	0.934988455934335	0.934815067632350	0.932933485689299	0.929830927904107	0.925754584162454	0.920844965277470	0.915189242526008	0.908845492892408	0.901854821690374	0.894247890128609	0.886048645348308	0.877276558445666	0.867948023235942	0.858077261336079	0.847676925553135	0.836758512728983	0.825332652731608	0.813409314877465	0.800997958056823	0.788107641695981	0.774747108978927	0.760924850095803
	0.890193432104886	0.923455827207957	0.932883769964031	0.935903099633357	0.936004484462816	0.934356064197063	0.931462399008690	0.927579206730762	0.922851608601001	0.917369427559457	0.911192323838357	0.904362362757036	0.896910781996121	0.888861858611357	0.880235229241904	0.871047340240515	0.861312385993071	0.851042934464933	0.840250355206341	0.828945118956196	0.817137011644760	0.804835290031981	0.792048796744520	0.778786046553517	0.765055291945696
	0.888752978482569	0.923390010471350	0.933369621507724	0.936734877305995	0.937099679850211	0.935673070502710	0.932976987591053	0.929275705804765	0.924718982660904	0.919399317090301	0.913377976067657	0.906698007926603	0.899391249529339	0.891482330363572	0.882991075000684	0.873934004632083	0.864325308651546	0.854177492376785	0.843501820227359	0.832308625949210	0.820607534203623	0.808407621722826	0.795717536425006	0.782545586750564	0.768899809557677
	0.887264109679298	0.923266443585308	0.933787812037049	0.937488939125224	0.938107062626150	0.936892172597085	0.934383616889835	0.930854252529168	0.926458496172276	0.921291544292562	0.915416291445002	0.908876789398821	0.901705494362782	0.893927408256778	0.885562563474792	0.876627575861743	0.867136649580854	0.857102247025239	0.846535547178456	0.835446766466896	0.823845387940062	0.811740327947130	0.799140059332681	0.786052703833481	0.772486102300053
	0.885728184219844	0.923087436162408	0.934141696680511	0.938169709342498	0.939032133928854	0.938019949588754	0.935689941005283	0.932323569936744	0.928079932397091	0.923056941528105	0.917319137995835	0.910911595188819	0.903867406632514	0.896211964511823	0.887965526784612	0.879144821627662	0.869764085607574	0.859835755794709	0.849370943314829	0.838379764835247	0.826871579340652	0.814855160333697	0.802338823113711	0.789330520235721	0.775837914059312
	0.884146411162022	0.922854998205866	0.934434180428858	0.938781011446636	0.939879643702014	0.939062079442330	0.936902563716219	0.933691182622802	0.929591729394746	0.924704850831495	0.919096750223460	0.912813538814115	0.905888963510362	0.898348822717015	0.890213615837501	0.881500199211791	0.872222857605651	0.862394018536813	0.852024741024454	0.841125057713838	0.829704219251056	0.817770872010109	0.805333189456409	0.792398970669399	0.778975715219749
	0.882519875007855	0.922570890044423	0.934667793158044	0.939326168290927	0.940653715893877	0.940023489169128	0.938027213533612	0.934963616484767	0.931001204222485	0.926243372297880	0.920758001362733	0.914592255044218	0.907780548031285	0.900349099266883	0.892318663863298	0.883706240549229	0.874526176488497	0.864790903825837	0.854511443639294	0.843697758706897	0.832359005482846	0.820503717352936	0.808139940084205	0.795275333412175	0.781917248247161
	0.880849555793214	0.922236662602426	0.934844750131613	0.939808082840794	0.941357949424257	0.940908475948669	0.939068884872806	0.936146559802482	0.932314733742199	0.927679564395798	0.922310622939492	0.916256138408372	0.909551206212228	0.902222478716011	0.894290979588114	0.885773862768045	0.876685550621982	0.867038492713143	0.856843684960460	0.846111033049649	0.834849612012548	0.823067855012088	0.810773692879016	0.797974658764428	0.784677967675703
	0.879136345410656	0.921853690119264	0.934967001158892	0.940229303781274	0.941995500220222	0.941720805539893	0.940031952755968	0.937244994115956	0.933537901525950	0.929019606721340	0.923761383162583	0.917812536983093	0.911208855961184	0.903977437504028	0.896139585438041	0.887712620502867	0.878711051847488	0.869147358027628	0.859032521372405	0.848376402040976	0.837188005205866	0.825475675368109	0.813247239981487	0.800510117170705	0.787271397597210
	0.877381060964472	0.921423196919814	0.935036270815321	0.940592079195868	0.942569148336214	0.942463792799431	0.940920266659537	0.938263301307156	0.934675618051402	0.930268933160636	0.925116232880988	0.919267910945620	0.912760458002794	0.905621427003331	0.897872412433096	0.889530912333293	0.880611533137134	0.871126792894278	0.861087670845451	0.850503992124680	0.839384702546600	0.827738068451776	0.815571824418449	0.802893284046362	0.789709424152452
	0.875584455768960	0.920946279460697	0.935054091565088	0.940898400772642	0.943081353229427	0.943140367990771	0.941737227800359	0.939205351785016	0.935732219686288	0.931432341553088	0.926380425783800	0.920627963147330	0.914212156640603	0.907161024264263	0.899496460688108	0.891236150791975	0.882394807839257	0.872984998925918	0.863017709761395	0.852502740015227	0.841448985707511	0.829864644583770	0.817757367913781	0.805134374340680	0.792002536406296
	0.873747228461283	0.920423924597166	0.935021831205592	0.941150040432154	0.943534299559422	0.943753131726131	0.942485853172775	0.940074577553009	0.936711550704115	0.932514084555189	0.927558617994497	0.921897747303155	0.915569396388647	0.908602056918268	0.901017932399184	0.892834903228472	0.884067798196092	0.874729242153524	0.864830235997584	0.854380562659086	0.843389077094752	0.831863917190408	0.819812659645969	0.807242436889163	0.794160025929975
	0.871870030595514	0.919857024805524	0.934940715737832	0.941348580850713	0.943929935354459	0.944304400751359	0.943168828912851	0.940874033098797	0.937617031630587	0.933517945360368	0.928654951066162	0.923081758149413	0.916837019164441	0.909949707263845	0.902442342665741	0.894333009195791	0.885636659108511	0.876365982968143	0.866532004830310	0.856144498869169	0.845212286968236	0.833743455150077	0.821745513546079	0.809225516373783	0.796190153119647
	0.869953473005215	0.919246390937032	0.934811848528078	0.941495441033931	0.944270003988701	0.944796246306257	0.943788555008965	0.941606446409883	0.938451716506817	0.934447301139948	0.929673121518026	0.924184006981466	0.918019345720938	0.911208599473704	0.903774612341422	0.895735678801272	0.887106881830801	0.877900984991156	0.868129042799821	0.857800827991530	0.846925136704639	0.835510010434849	0.823562900087953	0.811090789019404	0.798100286544382
	0.867998131161401	0.918592762958049	0.934636226444026	0.941591897852335	0.944556071110389	0.945230526428001	0.944347182952813	0.942274261934153	0.939218341110989	0.935305176467105	0.930616439392552	0.925208085264368	0.919120244220816	0.912382873032371	0.905019146224322	0.897047575528385	0.888483381292585	0.879339406754499	0.869626743596637	0.859355169835212	0.848533462597825	0.837169625598155	0.825271057269417	0.812844676864456	0.799897020291828
	0.866004549706201	0.917896819037836	0.934414753508456	0.941639104263822	0.944789547427211	0.945608913284817	0.944846647597957	0.942879676931114	0.939919363761293	0.936094288521760	0.931487877803739	0.926157218457266	0.920143188260873	0.913476244875699	0.906179899217956	0.898272886316715	0.889770569986596	0.880685879276227	0.871029949196136	0.860812569228278	0.850042503689977	0.838727724725892	0.826875584519463	0.814492944451499	0.801586273260705
	0.863973246306463	0.917159183273197	0.934148252504849	0.941638104802729	0.944971708073873	0.945932916409599	0.945288694239595	0.943424672370436	0.940556999998428	0.936817085514736	0.932290115053182	0.927034311764134	0.921091306192758	0.914492062209450	0.907260432568087	0.899415381129947	0.890972420773289	0.881944571999754	0.872343018822942	0.862177567890430	0.851456976428055	0.840189190744862	0.828381522519358	0.816040781014211	0.803173373559414
	0.861904714943429	0.916380432282682	0.933837474884619	0.941589848802226	0.945103709145390	0.946203902533480	0.945674901731432	0.943911039308770	0.941133252192609	0.937475779488867	0.933025570582801	0.927841989189287	0.921967423226044	0.915433347598329	0.908263961869762	0.900478463806584	0.892092520494537	0.883119249083442	0.873569887822973	0.863454265787690	0.852781138394925	0.841558431417788	0.829793421342606	0.817492870637004	0.804663130553645
	0.859799428732446	0.915561100858756	0.933483109259024	0.941495201727782	0.945186601868479	0.946423112586053	0.946006702300148	0.944340401498429	0.941649934921011	0.938072374434233	0.933696435791470	0.928582627013529	0.922774097516564	0.916302837613736	0.909193398216211	0.901465215646283	0.893134115928219	0.884213317648823	0.874714118125187	0.864646373722122	0.854018842936032	0.842839435910463	0.831115398860636	0.818853452391848	0.806059896621457
	0.857657842349235	0.914701686831298	0.933085788706162	0.941354954929227	0.945221344795545	0.946591676323444	0.946285398595045	0.944714234841393	0.942108696804162	0.938608690480345	0.934304700551652	0.929258382599211	0.923513651219177	0.917103016088795	0.910051383606035	0.902378432914365	0.894100153330549	0.885229869296505	0.875778941662161	0.865757258583454	0.855173586163755	0.844035823465814	0.832351190998856	0.820126372083893	0.807367620291374
	0.855480394125300	0.913802655267898	0.932646097081559	0.941169834062984	0.945208814335853	0.946710624961672	0.946512178412756	0.945033884190473	0.942511039364660	0.939086384789388	0.934852176110126	0.929871219267328	0.924188197306056	0.917836142838614	0.910840321522138	0.903220659232087	0.894993312586263	0.886171715960828	0.876767297869681	0.866789982430030	0.856248547552071	0.845150885440589	0.833504195139610	0.821315126940893	0.808589892134381
	0.853267507863957	0.912864442114110	0.932164574487337	0.940940506391333	0.945149813882544	0.946780902125541	0.946688127458646	0.945300577910337	0.942858333371383	0.939506969663701	0.935340514935284	0.930422927857674	0.924799662809211	0.918504278551176	0.911562403433476	0.903994213648200	0.895816036805450	0.887041420983889	0.877681866186384	0.867747336358956	0.857246625118601	0.846187621737156	0.834577507738077	0.822422904344016	0.809729984536981
	0.851019594419480	0.911887457358888	0.931641722028030	0.940667587129605	0.945045081749172	0.946803373369431	0.946814240443696	0.945515440539260	0.943151833051851	0.939871828291416	0.935771227975655	0.930915145476793	0.925349809031378	0.919109306431593	0.912219631840045	0.904701215049007	0.896570558059928	0.887841326136442	0.878525094314316	0.868631869958418	0.858170466017693	0.847148772483328	0.835573957031742	0.823452615506830	0.810790886286466
	0.848737053074662	0.910872087795930	0.931078005959252	0.940351644983087	0.944895298093061	0.946778834482657	0.946891430764752	0.945679503834488	0.943392688490243	0.940182228482009	0.936145699715205	0.931349371852582	0.925840249176788	0.919652951083261	0.912813840375968	0.905343603452237	0.897258919834122	0.888573575189315	0.879299222871764	0.869445917000111	0.859022493228002	0.848036845667951	0.836496131574193	0.824406924854828	0.811775332741046
	0.846420272746175	0.909818699439848	0.930473861317800	0.939993206991822	0.944701090973248	0.946708018756667	0.946920538974747	0.945793716436926	0.943581956475662	0.940439334684913	0.936465201346734	0.931726983644568	0.926272463778098	0.920136795028872	0.913346711399687	0.905923158639192	0.897882996669586	0.889240134538403	0.880006306964480	0.870191617920130	0.859804928904126	0.848854141322049	0.837346405202197	0.825288275732526	0.812685832228711
	0.844069633042341	0.908727639646485	0.929829695107247	0.939592762782162	0.944463041666633	0.946591603362374	0.946902340215756	0.945858952352401	0.943720610022039	0.940644218536455	0.936730902332194	0.932049247001905	0.926647814234307	0.920562293208447	0.913819791430257	0.906441516505403	0.898444511404070	0.889842811304150	0.880648235115529	0.870870939547091	0.860519814868858	0.849602772739008	0.838126958945577	0.826098912962739	0.813524689213581
	0.841685505193962	0.907599238978791	0.929145889101260	0.939150768308138	0.944181689346197	0.946430214962207	0.946837550760082	0.945876018415164	0.943809546745653	0.940797868141176	0.936943880575777	0.932317328614409	0.926967554724122	0.920930785737601	0.914234504731286	0.906900183449202	0.898945050341902	0.890383269259096	0.881226745923562	0.871485692462875	0.861169030646363	0.850284685148343	0.838839800307906	0.826840902698757	0.814294024682291
	0.839268252875649	0.906433812853184	0.928422802317125	0.938667649152668	0.943857535208829	0.946224434661928	0.946726833781798	0.945845660873345	0.943849596257055	0.940901196261212	0.937105131400166	0.932532305463475	0.927232842717746	0.921243509164835	0.914592165296761	0.907300549067531	0.899386076639614	0.890863042881591	0.881743442761283	0.872037546320942	0.861754309373812	0.850901672192544	0.839486780278887	0.827516149940961	0.814995794131982
	0.836818232932381	0.905231662995947	0.927660773203859	0.938143803447857	0.943491046126883	0.945974802391077	0.946570804462352	0.945768571214536	0.943841526700083	0.940955047560763	0.937215575487062	0.932695173447886	0.927444748275782	0.921501606429922	0.914893987453899	0.907643897386842	0.899768942147082	0.891283549787931	0.882199806777950	0.872528043397135	0.862277251877051	0.851455390502753	0.840069608383761	0.828126414032298	0.815631803482752
	0.834335796023803	0.903993078734754	0.926860121582611	0.937579604464695	0.943082657886333	0.945681820787524	0.946370034518168	0.945645391331884	0.943786050550604	0.940960205030422	0.937276065918790	0.932806855033119	0.927604262295412	0.921706135694908	0.915141095265669	0.907931416822578	0.900094897908149	0.891646101757079	0.882597208429883	0.872958610606438	0.862739339152805	0.851947372624365	0.840589866029012	0.828673322399547	0.816203723188695
	0.831821287196949	0.902718338146687	0.926021150371469	0.936975402915011	0.942632778065148	0.945345958650397	0.946125056225188	0.945476718116167	0.943683829770963	0.940917395697701	0.937287394437498	0.932868206050721	0.927712303840352	0.921858078193908	0.915334530888598	0.908164209032046	0.900365103494519	0.891951914530415	0.882936917729812	0.873330570184541	0.863141943463965	0.852379038506447	0.841049018365217	0.829158382767779	0.816713100781054
	0.829275046396474	0.901407709081013	0.925144147122095	0.936331529002312	0.942141788597653	0.944967654016339	0.945836366004370	0.945263107546918	0.943535480402114	0.940827295714573	0.937250297021535	0.932880021755941	0.927769726671159	0.921958345226551	0.915475262018804	0.908343296801517	0.900580635321405	0.892202116542432	0.883220113378114	0.873645149204132	0.863486338224481	0.852751705737766	0.841448424855759	0.829582994042330	0.817161372043022
	0.826697408920228	0.900061450072389	0.924229385391734	0.935648294252873	0.941610048064139	0.944547316906148	0.945504427623026	0.945005078345216	0.943341576663747	0.940690534899941	0.937165458864367	0.932843042236327	0.927777325075878	0.922007784402135	0.915564188540253	0.908469631088285	0.900742494072218	0.892397756715987	0.883447890915702	0.873903488071600	0.863773706825163	0.853066598686105	0.841789348713191	0.829948456024851	0.817549870987250
	0.824088705826869	0.898679811157929	0.923277125970791	0.934925993154102	0.941037893739467	0.944085331782317	0.945129675059174	0.944703115241971	0.943102654622823	0.940507700803937	0.937033518829386	0.932757957251000	0.927735839086922	0.922007185226493	0.915602148473190	0.908544097321454	0.900851611341705	0.892539811437011	0.883621270018709	0.874106648129338	0.864005150530445	0.853324856675542	0.842072965342285	0.830255978106611	0.817879838783081
	0.821449264301307	0.897263034609751	0.922287617983421	0.934164904623397	0.940425643429738	0.943582059752331	0.944712515069586	0.944357671908110	0.942819215482597	0.940279342351783	0.936855073443884	0.932625410569310	0.927645959158286	0.921957284110915	0.915589923307220	0.908567521050920	0.900908855591868	0.892629190807688	0.883741201038564	0.874255618471607	0.864181695558247	0.853527541317802	0.842300369909673	0.830506687062496	0.818152431760292
	0.818779407982995	0.895811355593028	0.921261099876196	0.933365293327648	0.939773597122189	0.943037840547905	0.944253329496669	0.943969173586782	0.942491728537172	0.940005973117089	0.936630680486859	0.932446003868275	0.927508330367108	0.921858768871686	0.915528242792042	0.908540673021879	0.900915037502201	0.892666744263726	0.883808570876961	0.874351322067258	0.864304299439847	0.853675643098048	0.842472584143685	0.830701634052399	0.818368728598882
	0.816079457261376	0.894325002758233	0.920197800307900	0.932527410870771	0.939082038470103	0.942452994306301	0.943752477344665	0.943538019462335	0.942120633830598	0.939688074267819	0.936360862218038	0.932220300240274	0.927323556195071	0.921712282779668	0.915417789249100	0.908464273741887	0.900870914784893	0.892653265629893	0.883824208273339	0.874394621270185	0.864373856743772	0.853770087302101	0.842590562454212	0.830841800922467	0.818529736799889
	0.813349729542282	0.892804198775131	0.919097938951812	0.931651496864451	0.938351236131651	0.941827823176427	0.943210296651627	0.943064584796286	0.941706344554410	0.939326097222494	0.936046108289294	0.931948827355724	0.927092201937869	0.921518428211565	0.915259201459155	0.908338997598699	0.900777196526413	0.892589497678293	0.883788888572277	0.874386322787759	0.864391204236673	0.853811739360641	0.842655197450607	0.830928105886559	0.818636398519728
	0.810590539488547	0.891249160815097	0.917961727220338	0.930737779895252	0.937581444979178	0.941162612769514	0.942627106180246	0.942549222856582	0.941249249213161	0.938920466049337	0.935686878374310	0.931632080319689	0.926814797784719	0.921277769947840	0.915053078173624	0.908165476579606	0.900634547108942	0.892476136245516	0.883703338029537	0.874327182168457	0.864357125544773	0.853801409676240	0.842667324925601	0.830961408657879	0.818689595839923
	0.807802199237706	0.889660100987490	0.916789368920639	0.929786478399629	0.936772907193318	0.940457633471628	0.942003206947640	0.941992266663121	0.940749713583701	0.938471579636936	0.935283604547801	0.931270524256431	0.926491841604594	0.920990838156543	0.914799981291515	0.907944303636554	0.900443589758327	0.892313833957677	0.883568237707995	0.874217907862086	0.864272355371354	0.853739857990667	0.842627728364560	0.830942515091885	0.818690155534954
	0.804985018599281	0.888037226735127	0.915581060848789	0.928797801456904	0.935925853254532	0.939713141633137	0.941338883611724	0.941394030569630	0.940208082490781	0.937979813661400	0.934836693441685	0.930864596651661	0.926123801471239	0.920658131097403	0.914500438738520	0.907676035735779	0.900204909759424	0.892103203606237	0.883384227008341	0.874059164899372	0.864137583318872	0.853627797342771	0.842537143031995	0.830872181393929	0.818638853393120
	0.802139305233861	0.886380741193251	0.914336993329093	0.927771949509047	0.935040502843122	0.938929380648380	0.940634405729616	0.940754811699525	0.939624681418755	0.937445522371933	0.934346528202219	0.930414709478583	0.925711117955112	0.920280117576320	0.914154947080345	0.907361196625937	0.899919057374633	0.891844821212205	0.883151906873860	0.873851578231884	0.863953457358239	0.853465897661002	0.842396259680862	0.830751117938491	0.818536418138549
	0.799265364815900	0.884690843515853	0.913057350704367	0.926709115015021	0.934117065657422	0.938106581937183	0.939890028901630	0.940074891251235	0.938999817976755	0.936869040214089	0.933813470269216	0.929921251130657	0.925254206206966	0.919857239176710	0.913763973898471	0.907000279354589	0.899586550497115	0.891539228811780	0.882871842703871	0.873595735768339	0.863720586982739	0.853254789029363	0.842205727924645	0.830579992741218	0.818383534996671
	0.796363501181936	0.882967729172790	0.911742311782323	0.925609483046525	0.933155742158727	0.937244965838481	0.939105995812834	0.939354535686640	0.938333783232671	0.936250683307654	0.933237860995930	0.929384588181283	0.924753457854843	0.919389912291037	0.913327959953155	0.906593748559329	0.899207877066408	0.891186936992530	0.882544567006262	0.873292191138990	0.863439546079485	0.852995064660865	0.841966159307471	0.830359434620033	0.818180848940389
	0.793434016465732	0.881211590220672	0.910392050242559	0.924473231831181	0.932156724250481	0.936344742425091	0.938282537182698	0.938593997814636	0.937626852929413	0.935590750794126	0.932620023126010	0.928805066988216	0.924209242733686	0.918878529973088	0.912847321155573	0.906142042556749	0.898783497270898	0.890788427205791	0.882170581815980	0.872941466216102	0.863110875547525	0.852687283608638	0.841678130103323	0.830090036077313	0.817928967649818
	0.790477211221665	0.879422615550201	0.909006735008161	0.923300533248477	0.931120195898414	0.935406112247627	0.937419872632166	0.937793517780480	0.936879288595418	0.934889526067030	0.931960262142018	0.928183015158468	0.923621910464545	0.918323463629182	0.912322450368489	0.905645575249760	0.898313845558774	0.890344153877990	0.881750360903213	0.872544053415257	0.862735085688277	0.852331973241279	0.841342183871851	0.829772355931459	0.817628464214668
	0.787493384537539	0.877600991112303	0.907586530585457	0.922091553283208	0.930046333697524	0.934429267014667	0.936518211476409	0.936953323970341	0.936091338559973	0.934147277896772	0.931258867498368	0.927518742887649	0.922991791898432	0.917725064564416	0.911753719052557	0.905104737871426	0.897799332476609	0.889854546340991	0.881284351792300	0.872100417799403	0.862312658391078	0.851929631506035	0.840958833795107	0.829406921722888	0.817279879604984
	0.784482834137864	0.875746900125161	0.906131597375052	0.920846452440592	0.928935307391136	0.933414390215422	0.935577753450583	0.936073633839401	0.935263238882725	0.933364261460436	0.930516113750067	0.926812544186119	0.922319200438148	0.917083665398245	0.911141478773524	0.904519900581429	0.897240346352578	0.889320010599323	0.880772977610034	0.871610999005092	0.861844049134031	0.851480729000730	0.840528564816815	0.828994231916712	0.816883724933091
	0.781445856478534	0.873860523263984	0.904642091956953	0.919565386126801	0.927787280346718	0.932361657690532	0.934598689375108	0.935154654670954	0.934395214205750	0.932540719285762	0.929732261587394	0.926064698002966	0.921604433249973	0.916399581362097	0.910486062583812	0.903891413929507	0.896637254839399	0.888740930950134	0.880216638779933	0.871076213008207	0.861329688818123	0.850985710873029	0.840051835603364	0.828534757921855	0.816440483527055
	0.778382746833712	0.871942038835186	0.903118167352248	0.918248504998206	0.926602409992583	0.931271238155938	0.933581201766268	0.934196584273108	0.933487478535568	0.931676882117545	0.928907558785545	0.925275469257597	0.920847772375747	0.915673111490333	0.909787786290557	0.903219610198590	0.895990406330461	0.888117671469991	0.879615714577260	0.870496453744552	0.860769985450586	0.850444998563599	0.839529080343627	0.828028945944213	0.815950612833705
	0.775293799375679	0.869991622936437	0.901559973263577	0.916895955282311	0.925380848219181	0.930143293684282	0.932525465397296	0.933199611619000	0.932540235961768	0.930772969713774	0.928042241077265	0.924445109787695	0.920049485754801	0.914904539714644	0.909046949620835	0.902504804639050	0.895300131261130	0.887450577381143	0.878970564557960	0.869872094599050	0.860165325691771	0.849858991407936	0.838960710402847	0.827477218689569	0.815414546167373
	0.772179307248297	0.868009449603916	0.899967656296361	0.915507879073013	0.924122741748292	0.928977980147792	0.931431647814585	0.932163917435797	0.931553681318134	0.929829191578091	0.927136532955687	0.923573859221327	0.919209828164115	0.914094135870892	0.908263837293658	0.901747296604206	0.894566743305949	0.886739976308473	0.878281529873278	0.869203489775797	0.859516076278277	0.849228068110040	0.838347115844212	0.826879976930259	0.814832694318723
	0.769039562634661	0.865995690947930	0.898341360162568	0.914084414602547	0.922828232473068	0.927775447626204	0.930299909813131	0.931089674747192	0.930528000791581	0.928845747634415	0.926190648413774	0.922661945780212	0.918329042084268	0.913242156626474	0.907438720007353	0.900947370596176	0.893790540481327	0.885986179437219	0.877548934480597	0.868490975559963	0.858822585333722	0.848552588099753	0.837688666830304	0.826237600948168	0.814205447036571
	0.765874856819491	0.863950517277979	0.896681225868595	0.912625696492244	0.921497457771583	0.926535840782899	0.929130405874940	0.929977049373631	0.929463372483639	0.927822828849004	0.925204791626150	0.921709587020394	0.917407358497907	0.912348846335411	0.906571855349995	0.900105297230250	0.892971806162299	0.885189482580481	0.876773086259925	0.867734871481357	0.858085183577379	0.847832892784324	0.836985714915351	0.825550451865276	0.813533174394240
	0.762685480246720	0.861874097218184	0.894987391888709	0.911131855984000	0.920130550796259	0.925259299212106	0.927923284573706	0.928826200394057	0.928359966928749	0.926760617804663	0.924179157578483	0.920716990515937	0.916444997626787	0.911414437827669	0.905663488639804	0.899221334125064	0.892110810021075	0.884350167164620	0.875954278044491	0.866935481388486	0.857304185439839	0.847069306703708	0.836238594238066	0.824818872871858	0.812816228050813
	0.759471722572708	0.859766597813961	0.893259994325302	0.909603021154164	0.918727640741312	0.923945957759730	0.926678688948751	0.927637280572591	0.927217947573188	0.925659289231344	0.923113932649059	0.919684354490697	0.915442169612848	0.910439153138533	0.904713853701723	0.898295726725174	0.891207808894308	0.883468501139808	0.875092788573074	0.866093094441049	0.856479890093939	0.846262138598114	0.835447622623895	0.824043190361400	0.812054942416582
	0.756233872715462	0.857628184630689	0.891499167057135	0.908039317111385	0.917288853090143	0.922595946820130	0.925396756850931	0.926410436753204	0.926037471218085	0.924519010496947	0.922009295146749	0.918611868402708	0.914399075148197	0.909423204183267	0.903723173585746	0.897328709061941	0.890263047585317	0.882544739822287	0.874188883370910	0.865207986027980	0.855612582408373	0.845411682395486	0.834613102604599	0.823223714980401	0.811249635731109
	0.752972218900220	0.855459021845072	0.889705041876603	0.906440866179802	0.915814309844396	0.921209392610897	0.924077621262902	0.925145810225162	0.924818688429611	0.923339942061770	0.920865415809120	0.917499713485284	0.913315906058436	0.908366793381814	0.902691661232036	0.896320504458044	0.889276759606886	0.881579126674248	0.873242815565337	0.864280418617499	0.854702533830663	0.844518218125846	0.833735322362305	0.822360742600408	0.810400611061408
	0.749687048701686	0.853259272329811	0.887877748616945	0.904807788068832	0.914304129736264	0.919786417427542	0.922721410595970	0.923843537061728	0.923561743919162	0.922122237899701	0.919682458264096	0.916348063248528	0.912192845843298	0.907270114237775	0.901619520087382	0.895271326180448	0.888249167869707	0.880571894026633	0.872254826641770	0.863310642544963	0.853750003205526	0.843582012768725	0.832814556604488	0.821454555218928	0.809508157227110
	0.746378649083224	0.851029097732160	0.886017415270274	0.903140200030683	0.912758428425441	0.918327139879761	0.921328248965469	0.922503748434374	0.922266776896054	0.920866045888972	0.918460579458254	0.915157083944582	0.911030070178209	0.906133351875540	0.900506944677086	0.894181378046174	0.887180485321066	0.879523263749695	0.871225147145016	0.862298896743754	0.852755237534073	0.842603321039340	0.831851067375693	0.820505421795213	0.808572549658733
	0.743047306433245	0.848768658546870	0.884124168097161	0.901438217006619	0.911177318682014	0.916831675110832	0.919898256446474	0.921126570904560	0.920933921395030	0.919571508174985	0.917199930054521	0.913926934999649	0.909827747380019	0.904956683539050	0.899354121136006	0.893050854984796	0.886070915537899	0.878433447875655	0.870153997330507	0.861245409423977	0.851718472678791	0.841582386118606	0.830845104811283	0.819513599026348	0.807594051194654];

% Electric motor efficiency
e =  interp2(Tm_list,wm_list,etam,abs(Tm),wg.*ones(size(Tm)));
e(isnan(e)) = 1;
% Summarize infeasible
inm = (isnan(e)) + (Tm<0)  .* (Tm < interp1(wm_list,Tmmin,wg,'linear','extrap')) +...
                   (Tm>=0) .* (Tm > interp1(wm_list,Tmmax,wg,'linear','extrap'));


% Calculate electric power consumption
Pm =  (Tm<0) .* wg.*Tm.*e + (Tm>=0) .* wg.*Tm./e;

% BATTERY SIMPLIFIED MODEL-Only a constant voltage generator
Vn = 100;
% columbic efficiency (0.9 when charging)
eff = (Pm>0) + (Pm<=0) .* 0.9;
% Battery current limitations
battery_capacity = 45; %Ah 
max_disch_curr = 100;   %A
max_char_curr    = 125; %A
im = (Pm>0) .* max_disch_curr + (Pm<=0) .* max_char_curr;
% Battery current
r = 39e-3; %ohm
Ib  =   eff .* (Vn-sqrt(Vn.^2 - 4.*r.*Pm))./(2.*r);
% New battery state of charge simplified
X{1}  = -1/(battery_capacity.*3600).*Pm./Vn+inp.X{1};
% Battery power consumption
Pb =   Ib .* Vn;
% Update infeasible 
inb = (Vn.^2 < 4.*r.*Pm) + (abs(Ib)>im);
% Set new state of charge to real values
X{1} = (conj(X{1})+X{1})/2;
Pb   = (conj(Pb)+Pb)/2;
Ib   = (conj(Ib)+Ib)/2;

% COST
% Summarize infeasible matrix
I = (inps+inb+ine+inm~=0);
% Calculate cost matrix (fuel mass flow)
C{1}  = (Pe ./ gasoline_lower_heating_value);

% SIGNALS
%   store relevant signals in out
out.Te = Te;
out.Tm = Tm;
out.Ttot = Ttot;
out.Tema = Te_max;
out.Pe = Pe;
out.Pe2= Pe2;
out.UU= Tm./Tv;
out.u = inp.U{1};
out.etaeng = e_th;
out.eta = e_th2;
out.nmarce=inp.W{3} + (inp.W{3}==0);
% REVISION HISTORY
% =========================================================================
% DATE      WHO                 WHAT
% -------------------------------------------------------------------------
% 




